# SPDX-FileCopyrightText: Contributors to Open-TYNDP <https://github.com/open-energy-transition/open-tyndp>
# SPDX-FileCopyrightText: Contributors to PyPSA-Eur <https://github.com/pypsa/pypsa-eur>
#
# SPDX-License-Identifier: CC0-1.0

run:
  name: "test-sector-tyndp"
  disable_progressbar: true
  shared_resources:
    policy: false
  shared_cutouts: true

# TODO set foresight
foresight: myopic

tyndp_scenario: NT

scenario:
  clusters:
  - all
  planning_horizons:
  - 2030
  - 2035
  - 2040

countries: ['AL', 'AT', 'BA', 'BE', 'BG', 'CH', 'CZ', 'CY', 'DE', 'DK', 'EE', 'ES', 'FI', 'FR', 'GB', 'GR', 'HR', 'HU', 'IE', 'IT', 'LT', 'LU', 'LV', 'ME', 'MK', 'MT', 'NL', 'NO', 'PL', 'PT', 'RO', 'RS', 'SE', 'SI', 'SK']

snapshots:
  start: "2013-03-01"
  end: "2013-03-08"

co2_budget:

electricity:
  base_network: tyndp

  extendable_carriers:
    Generator: [OCGT]
    StorageUnit: [battery]
    Store: [H2]
    Link: [H2 pipeline]

  conventional_carriers: [OCGT]
  tyndp_conventional_carriers:
  - gas
  - coal
  - lignite
  - uranium
  - oil-light
  - oil-heavy
  - oil-shale
  group_tyndp_conventionals: true
  renewable_carriers: []
  tyndp_renewable_carriers:
  - other-res
  - hydro-ror
  - hydro-reservoir
  - hydro-pondage
  - hydro-phs
  - hydro-phs-pure
  - onwind
  - solar-pv-utility
  - solar-pv-rooftop
  - offwind-ac-fb-r
  - offwind-ac-fl-r
  - offwind-dc-fb-r
  - offwind-dc-fl-r
  - offwind-dc-fb-oh
  - offwind-dc-fl-oh
  - offwind-h2-fb-oh
  - offwind-h2-fl-oh
  tyndp_stores:
  - battery
  - h2_cavern
  - h2_tank
  estimate_renewable_capacities:
    enable: false

  pecd_renewable_profiles:
    enable: true
    version: 3.1
    pre_built:
      retrieve: true
      pecd_prebuilt_version: 0.1
      cyears:
      - 1995
      - 2008
      - 2009
    fill_gaps_method: zero
    # Complete PECD data is only available for the years 2030, 2040
    # TODO: adjust once udpated 2050 PECD data is available
    available_years:
    - 2030
    - 2040
    technologies:
    - Wind_Offshore
    - LFSolarPVRooftop
    - LFSolarPVUtility
    - Wind_Onshore

  pemmdb_hydro_profiles:
    enable: true
    available_years:
    - 2030
    - 2040
    - 2050
    technologies:
    - Run_of_River
    - Pondage
    - Reservoir
    - PS_Open
    - PS_Closed

  pemmdb_capacities:
    enable: true
    nprocesses: 4
    available_years:
    - 2030
    - 2040
    - 2050
    technologies:
    - Solar
    - Wind
    - Hydro
    - Other_RES
    - Gas
    - Nuclear
    - Hard_coal
    - Lignite
    - Light_oil
    - Heavy_oil
    - Oil_shale
    - Other_Non-RES
    - Hydrogen
    - Electrolyser
    - Battery

  transmission_limit: v1.0

atlite:
  default_cutout: europe-2013-03-sarah3-era5
  cutouts:
    europe-2013-03-sarah3-era5:
      time: ["2013-03-01", "2013-03-08"]

renewable:
  offwind-ac:
    max_depth: false
  offwind-dc:
    max_depth: false
  offwind-float:
    max_depth: false
    min_depth: false

links:
  p_max_pu: 1.0
  p_min_pu: 0

transmission_projects:
  enable: true
  include:
    tyndp2020: false
    nep: false
    manual: false

load:
  source: tyndp # opsd, tyndp
  fill_gaps:
    enable: false
  available_years_tyndp:
  - 2030
  - 2040
  - 2050
  manual_adjustments: false
  supplement_synthetic: false

pypsa_eur:
  Bus:
  - AC
  Link:
  - DC
  Generator:
  - ror
  StorageUnit:
  - PHS
  - hydro
  Store: []

biomass:
  share_unsustainable_use_retained:
    2020: 0
    2025: 0
    2030: 0
    2035: 0
    2040: 0
    2045: 0
    2050: 0
  share_sustainable_potential_available:
    2020: 1
    2025: 1
    2030: 1
    2035: 1
    2040: 1
    2045: 1
    2050: 1

sector:
  transport: true
  heating: false
  biomass: true
  industry: false
  shipping: true
  aviation: true
  agriculture: false
  fossil_fuels: true

  land_transport_fuel_cell_share:  # Not modelled
    2030: 0
    2035: 0
    2040: 0
    2045: 0
    2050: 0
  land_transport_electric_share:  # included in exogenous demand
    2030: 0
    2035: 0
    2040: 0
    2045: 0
    2050: 0
  land_transport_ice_share:  # TODO Improve TYNDP 2024 approximations
    2030: 0.96
    2035: 0.82  # interpolation
    2040: 0.68
    2045: 0.42  # interpolation
    2050: 0.16
  shipping_hydrogen_share:  # included in exogenous demand  # TODO Validate assumption
    2030: 0
    2035: 0
    2040: 0
    2045: 0
    2050: 0
  shipping_methanol_share:  # included in exogenous demand  # TODO Validate assumption
    2030: 0
    2035: 0
    2040: 0
    2045: 0
    2050: 0
  shipping_oil_share:
    2030: 0.85
    2035: 0.65
    2040: 0.45
    2045: 0.2
    2050: 0
  oil_boilers: false
  biomass_boiler: false
  solar_thermal: false
  ATR: false
  regional_co2_sequestration_potential:
    enable: false
  co2_sequestration_potential:
    # Values from TYNDP 2024 Supply Tool
    2030: 47
    2035: 167
    2040: 344
  co2_spatial: false
  co2_network: false
  methanol:
    methanol_to_power:
      ocgt: false
    biomass_to_methanol: false
  ammonia: false
  h2_topology_tyndp: true
  h2_zones_tyndp: false
  gas_network: false
  gas_demand_exogenously: true
  biomass_spatial: false
  biomass_to_liquid: true
  biomass_to_liquid_cc: true
  force_biomass_potential: true
  force_biogas_potential: true
  biomass_final_demand: # in TWh
    2030: 902
    2035: 815   # linear interpolation
    2040: 728
  electrobiofuels: false
  transmission_efficiency:
    enable:
    - gas pipeline
  imports:
    enable: true
    carriers:
    - H2
  offshore_hubs_tyndp:
    enable: true
    max_capacity:
      DC_OH: 10
      H2 pipeline OH: 30

costs:
  overwrites:
    lifetime:
      electrolysis: 25
      HVDC submarine: 25
      H2 (g) submarine pipeline: 25
      offwind: 25
    efficiency:
      electrolysis: 0.68  # ToDo Account for time-varying efficiencies, currently using fixed 2020 value from TYNDP 2024
  emission_prices:
    enable: true
    co2:
      # Source: Methodology report, p32
      2030: 113.4
      2035: 130.2 # interpolated
      2040: 147
      2045: 157.5 # interpolated
      2050: 168

clustering:
  mode: administrative
  administrative:
    level: bz
  build_bidding_zones:
    remove_islands: true
    aggregate_to_tyndp: true
  simplify_network:
    remove_stubs: false
  temporal:
    resolution_sector: 6H

adjustments:
  electricity: false
  sector:
    factor:
      Generator:
        biogas:
          p_nom:
            2030: 1.26  # EU27 biogas potential: PyPSA-Eur 301 TWh vs TYNDP 379 TWh
            2035: 1.89  # interpolated
            2040: 2.51  # EU27 biogas potential: PyPSA-Eur 306 TWh vs TYNDP 767 TWh
          e_sum_max:
            2030: 1.26
            2035: 1.89
            2040: 2.51
          e_sum_min:
            2030: 1.26
            2035: 1.89
            2040: 2.51
        solid biomass:
          p_nom:
            2030: 1.47 # EU27 biomass potential: PyPSA-Eur 974 TWh vs TYNDP 1431 TWh
            2035: 1.40 # interpolated
            2040: 1.33 # EU27 biomass potential: PyPSA-Eur 950 TWh vs TYNDP 1261 TWh
          e_sum_max:
            2030: 1.47
            2035: 1.40
            2040: 1.33
          e_sum_min:
            2030: 1.47
            2035: 1.40
            2040: 1.33
    absolute: false

solving:
  solver:
    name: highs
    options: highs-default
  mem: 4000

plotting:
  energy_threshold: 1.
  projection:
    name: "LambertAzimuthalEqualArea"
  balance_map:
    imports_as_flows: true
    bus_carriers:
    - AC
    - H2
    - gas
    - oil
    - co2 stored
    H2:
      bus_factor: 0.005
      branch_factor: 0.04
      flow_factor: 25

benchmarking:
  enable: true
